<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Display Antrian Apotek - RSUD Sultan Suriansyah</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#584566;
      --red:#BF5268;
      --orange:#F3915A;
      --yellow:#F4C578;
      --green:#86A874;
      --green-dark:#54856B;
      --teal:#446870;
      --ink:#ffffff;
      --ink-dark:#584566;
    }

    * { box-sizing: border-box; }
    body {
      font-family: 'Poppins', sans-serif;
      background-color: var(--bg);
      color: #cfe7ff;
      text-align: center;
      padding: 20px;
      margin: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    h1, h2, h3 { margin: 10px 0; }

    h2 {
      font-weight: 600;
      color: var(--yellow);
      letter-spacing: .5px;
    }

    h3 {
      font-size: 28px;
      font-weight: 600;
      text-transform: uppercase;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      color: inherit;
      margin-top: 0;
    }

    .container {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 16px;
      flex-wrap: wrap;
      width: 100%;
    }

    .box {
      flex: 1;
      min-width: 260px;
      padding: 24px;
      border-radius: 14px;
      box-shadow: 0 6px 16px rgba(0,0,0,0.35);
      color: var(--ink);
    }

    /* Warna box sesuai palet */
    .umum      { background-color: var(--green-dark); color: var(--ink); }
    .bpjs      { background-color: var(--green);      color: var(--ink-dark); }
    .prioritas { background-color: var(--red);        color: var(--ink); }
    .racikan   { background-color: var(--orange);     color: var(--ink); flex-basis: 100%; margin-top: 20px; }
    .konfirmasi{ background-color: var(--yellow);     color: var(--ink-dark); flex-basis: 100%; margin-top: 20px; }

    h1 {
      font-size: clamp(38px, 7vw, 72px);
      font-weight: 700;
      margin: 10px 0 0 0;
      line-height: 1;
    }

    #racikan, #konfirmasiList {
      font-size: clamp(36px, 6.5vw, 64px);
      line-height: 1.4;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 12px;
    }

    #clock {
      font-size: 18px;
      margin-top: 4px;
      color: #f4f4f4;
      opacity: .9;
    }

    .separator {
      height: 4px;
      background-color: rgba(255,255,255,0.45);
      margin: 12px auto 8px;
      border-radius: 2px;
      width: 80%;
    }
    .bpjs .separator, .konfirmasi .separator {
      background-color: rgba(0,0,0,0.18);
    }

    svg { width: 24px; height: 24px; fill: currentColor; }

    #motivasi {
      position: fixed;
      bottom: 0;
      left: 0; right: 0;
      background-color: var(--teal);
      color: var(--ink);
      text-align: center;
      font-size: clamp(16px, 2.2vw, 22px);
      font-weight: 700;
      padding: 10px 12px;
      font-family: 'Segoe UI', system-ui, sans-serif;
      transition: opacity 1s ease-in-out;
      opacity: 1;
      box-shadow: 0 -2px 10px rgba(0,0,0,0.35);
      z-index: 10;
    }

    /* Tombol fullscreen (ikon) */
    .fullscreen-btn {
      position: fixed;
      top: 14px;
      right: 14px;
      background-color: var(--green-dark);
      border: none;
      border-radius: 50%;
      padding: 10px;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0,0,0,0.25);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      transition: background-color .2s ease;
    }
    .fullscreen-btn:hover { background-color: var(--teal); }
    .fullscreen-btn svg { width: 20px; height: 20px; fill: #fff; }

    @media (min-width: 1400px) {
      h1 { font-size: 84px; }
      #racikan, #konfirmasiList { font-size: 72px; }
    }
  </style>
</head>
<body>
  <h2>RSUD SULTAN SURIANSYAH</h2>
  <div id="clock"></div>

  <!-- Tombol Fullscreen (ikon dinamis) -->
  <button class="fullscreen-btn" onclick="toggleFullScreen()" title="Layar Penuh">
    <svg id="fullscreen-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
      <!-- Masuk fullscreen -->
      <path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zm-3-12v2h3v3h2V5h-5z"/>
    </svg>
  </button>

  <div class="container">
    <div class="box umum">
      <h3>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17.93c-2.83.48-5.51-1.51-6-4.34-.49-2.82 1.5-5.5 4.34-5.99V5h2v4.59c2.83.49 4.82 3.17 4.33 5.99-.49 2.83-3.17 4.82-5.99 4.34z"/></svg>
        RESEP UMUM
      </h3>
      <div class="separator"></div>
      <h1 id="umum">A00</h1>
    </div>

    <div class="box bpjs">
      <h3>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 4.14c-3.95 0-7.17 3.22-7.17 7.17s3.22 7.17 7.17 7.17 7.17-3.22 7.17-7.17S15.95 4.14 12 4.14zm0 12.35c-2.86 0-5.18-2.32-5.18-5.18S9.14 6.14 12 6.14s5.18 2.32 5.18 5.18-2.32 5.18-5.18 5.18z"/></svg>
        RESEP BPJS
      </h3>
      <div class="separator"></div>
      <h1 id="bpjs">B00</h1>
    </div>

    <div class="box prioritas">
      <h3>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
        RESEP PRIORITAS
      </h3>
      <div class="separator"></div>
      <h1 id="prioritas">C00</h1>
    </div>

    <div class="box racikan">
      <h3>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 14c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"/></svg>
        SEDANG DIRACIK
      </h3>
      <div class="separator"></div>
      <div id="racikan">-</div>
    </div>

    <div class="box konfirmasi">
      <h3>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM7 12h10v2H7v-2z"/></svg>
        SEDANG KONFIRMASI
      </h3>
      <div class="separator"></div>
      <div id="konfirmasiList">-</div>
    </div>
  </div>

  <div id="motivasi"></div>

  <script>
    // ====== KONFIG: URL Apps Script kamu ======
    const sheetUrlBase = "https://script.google.com/macros/s/AKfycbxY27xj_t6dt2yN9nflP7FTfLpDqwKgXm8hXO1w-DOL8uD4iRJnV9x_sjwAaHwSjSxz4Q/exec";

    // ====== Jam real-time ======
    function updateClock() {
      const now = new Date();
      const waktu = now.toLocaleString("id-ID", {
        weekday: 'long', year: 'numeric', month: 'long', day: 'numeric',
        hour: '2-digit', minute: '2-digit', second: '2-digit'
      });
      document.getElementById("clock").innerText = waktu;
    }

    // ====== Ambil data ======
    async function fetchData() {
      try {
        const res = await fetch(`${sheetUrlBase}?_t=${Date.now()}`, { cache: "no-store" });
        const data = await res.json();

        // Field utama
        document.getElementById("umum").innerText = data.umum || "-";
        document.getElementById("bpjs").innerText = data.bpjs || "-";
        document.getElementById("prioritas").innerText = data.prioritas || "-";

        // Racikan: multi nomor dipisah koma => tampil dengan separator "|"
        if (data.racikan && data.racikan !== "-") {
          const list = data.racikan.split(",").map(n => n.trim()).filter(Boolean);
          document.getElementById("racikan").innerHTML = list
            .map((n, i) => i === list.length - 1
              ? `<span>${n}</span>`
              : `<span>${n}</span><span style="opacity:.6; margin:0 10px;">|</span>`).join("");
        } else {
          document.getElementById("racikan").innerText = "-";
        }

        // Konfirmasi: dukung header "konfirmasi" ATAU "sedang dikonfirmasi ke dokter"
        const konfirmasiRaw = data.konfirmasi ?? data["sedang dikonfirmasi ke dokter"];
        if (konfirmasiRaw && konfirmasiRaw !== "-") {
          const listK = konfirmasiRaw.split(",").map(n => n.trim()).filter(Boolean);
          document.getElementById("konfirmasiList").innerHTML = listK
            .map((n, i) => i === listK.length - 1
              ? `<span>${n}</span>`
              : `<span>${n}</span><span style="opacity:.6; margin:0 10px;">|</span>`).join("");
        } else {
          document.getElementById("konfirmasiList").innerText = "-";
        }

      } catch (e) {
        console.error("Gagal mengambil data:", e);
      }
    }

    // ====== Motivasi berganti ======
    const pesanMotivasi = [
      "Setiap hari adalah langkah menuju kesembuhan.",
      "Jangan menyerah, tubuh Anda sedang berjuang.",
      "Kesabaran adalah bagian dari proses penyembuhan.",
      "Tetap tersenyum, itu obat terbaik.",
      "Anda lebih kuat dari yang Anda kira.",
      "Hari ini sakit, besok insyaAllah lebih baik.",
      "Semangat! Kesembuhan sudah menunggu.",
      "Sakit itu sementara, semangat itu selamanya.",
      "Bersyukur untuk setiap kemajuan sekecil apapun.",
      "Perjalanan menuju sehat dimulai dari pikiran yang kuat."
    ];
    let indexMotivasi = 0;
    const motivasiEl = document.getElementById("motivasi");

    function tampilkanMotivasi() {
      motivasiEl.style.opacity = 0;
      setTimeout(() => {
        motivasiEl.textContent = pesanMotivasi[indexMotivasi];
        motivasiEl.style.opacity = 1;
        indexMotivasi = (indexMotivasi + 1) % pesanMotivasi.length;
      }, 500);
    }

    // ====== Fullscreen toggle + ikon dinamis ======
    function toggleFullScreen() {
      const el = document.documentElement;
      if (!document.fullscreenElement) {
        if (el.requestFullscreen) el.requestFullscreen();
        else if (el.webkitRequestFullscreen) el.webkitRequestFullscreen();
        else if (el.msRequestFullscreen) el.msRequestFullscreen();
      } else {
        if (document.exitFullscreen) document.exitFullscreen();
        else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
        else if (document.msExitFullscreen) document.msExitFullscreen();
      }
    }
    document.addEventListener("fullscreenchange", () => {
      const icon = document.getElementById("fullscreen-icon");
      if (document.fullscreenElement) {
        // ikon "exit fullscreen"
        icon.innerHTML = `<path d="M5 8h2V5h3V3H5v5zm9-5v2h3v3h2V3h-5zm3 13h-3v3h-2v5h5v-5zm-9 3v-3H5v-2H3v5h5z"/>`;
      } else {
        // ikon "enter fullscreen"
        icon.innerHTML = `<path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zm-3-12v2h3v3h2V5h-5z"/>`;
      }
    });

    // ====== Inisialisasi ======
    updateClock();
    tampilkanMotivasi();
    fetchData();

    setInterval(updateClock, 1000);
    setInterval(fetchData, 3000);
    setInterval(tampilkanMotivasi, 6000);
  </script>
</body>
</html>
